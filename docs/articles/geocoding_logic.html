<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Logique du géocodage • phacochrdev</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Logique du géocodage">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">phacochrdev</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/geocoding_logic.html">Logique du géocodage</a></li>
    <li><a class="dropdown-item" href="../articles/data_phacochr.html">Structure et mise à jour des données BeST</a></li>
    <li><a class="dropdown-item" href="../articles/performances.html">Performances et fiabilité</a></li>
    <li><a class="dropdown-item" href="../articles/anonymous_geocoding.html">Géocodage anonymisé</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/shiny_app.html">Géocoder en ligne</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/phacochr/"><span class="fa fa-github fa-lg"></span> github</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Logique du géocodage</h1>
            
      
      <small class="dont-index">Source: <a href="NA/NA/NA/blob/HEAD/vignettes/geocoding_logic.Rmd"><code>vignettes/geocoding_logic.Rmd</code></a></small>
      <div class="d-none name"><code>geocoding_logic.Rmd</code></div>
    </div>

    
    
<p>Nous expliquons ici avec plus de détail la logique du traitement
réalisé par <code>phacochr</code>. Celui-ci repose sur les données BeST
Address, que nous avons reformatées pour optimiser le traitement. Nous
avons également utilisé des données produites par Statbel et Urbis dans
ce reformatage. Nous ne rentrons pas dans l’explication de ces
modifications ici, et renvoyons à la page dédiée à la <a href="https://phacochr.github.io/phacochrdev/articles/data_phacochr.html">structure
et la mise à jour des données</a> pour plus de précisions.</p>
<p>Nous nous concentrons ici sur les opérations réalisées par la
fonction <code><a href="../reference/phaco_geocode.html">phaco_geocode()</a></code>, fonction de géocodage à
proprement parler. Si l’on schématise, ces opérations se classent en
trois grandes familles :</p>
<div class="section level2">
<h2 id="formatage-des-données">1) Formatage des données<a class="anchor" aria-label="anchor" href="#formatage-des-donn%C3%A9es"></a>
</h2>
<p>Le programme détecte d’abord la configuration des données à géocoder,
et créé les colonnes nettoyées de numéro de rue (si disponible, ce qui
est souvent le cas), de rue et de code postal. Des corrections sont
faites pour chacun de ces champs, afin de maximiser les chances de
trouver l’adresse dans la suite des opérations.</p>
</div>
<div class="section level2">
<h2 id="détection-des-rues">2) Détection des rues<a class="anchor" aria-label="anchor" href="#d%C3%A9tection-des-rues"></a>
</h2>
<p><code>phacochr</code> procède alors à une <em>jointure inexacte</em>
entre chacune des rues (nettoyées au point précédent) et l’ensemble des
rue de BeST Address <em>au sein du code postal indiqué</em>. Un matching
inexact est nécessaire pour pouvoir apparier la rue des données BeST
(disons <em>Rue Belliard</em> au code postal 1040) avec la même rue
telle qu’elle est écrite concrètement dans la base de données à
géocoder, potentiellement avec des coquilles ou fautes d’orthographe
(par exemple <em>Rue Beliar</em> avec un seul <em>l</em> et sans
<em>d</em>, également au code postal 1040). Le matching inexact est
parallélisé sur les n-1 cores du CPU afin d’augmenter la vitesse du
traitement (de nombreuses combinaisons devant être calculées). Le
paramètre <code>error_max</code> permet d’indiquer l’erreur acceptable
par l’utilisateur. Celle-ci est réglée par défaut à <code>4</code>, ce
qui permet de trouver des rues mal orthographiées, sans les confondre
avec d’autres, avec un très bon taux de succès. Augmenter ce paramètre
accroît le pourcentage de rues trouvées, mais aussi d’erreurs réalisées.
Dans le cas où la langue dans laquelle les adresses sont inscrites est
connue, elle peut être renseignée via l’argument
<code>lang_encoded</code>, ce qui augmente la vitesse et la fiabilité du
processus en limitant le matching à la langue définie. Si la rue n’est
pas trouvée, le programme étend sa recherche à la commune entière et à
toutes les communes limitrophes. Cette procédure optionnelle peut être
désactivée avec le paramètre
<code>elargissement_com_adj = FALSE</code>.</p>
</div>
<div class="section level2">
<h2 id="jointure-avec-les-coordonnées-géographiques">3) Jointure avec les coordonnées géographiques<a class="anchor" aria-label="anchor" href="#jointure-avec-les-coordonn%C3%A9es-g%C3%A9ographiques"></a>
</h2>
<p>Une fois les rues trouvées, il est désormais possible de réaliser une
<em>jointure exacte</em> avec les données BeST géolocalisées au niveau
du numéro, celles-ci comprenant les coordonnées X-Y de l’ensemble des
adresses en Belgique. Pour ce faire, seuls les arrondissements dans
lesquels sont présents les codes postaux des données à géocoder sont
chargés en RAM, pour augmenter la vitesse du traitement et soulager
l’ordinateur. Les coordonnées des adresses qui ne sont pas trouvées sont
approximées en trouvant les coordonnées connues de l’adresse la plus
proche du même côté de la rue. L’amplitude maximale de cette
approximation est réglable avec le paramètre <code>approx_num_max</code>
(réglé par défaut à <code>50</code> ; indiquer <code>0</code> pour
désactiver l’approximation). Dans le cas où les coordonnées ne sont pas
trouvées, ce sont celles du numéro médian de la rue (proxy du milieu de
la rue) qui sont indiquées (option activée par défaut et désactivable
avec l’argument <code>mid_street = FALSE</code>). Si les données ne
possèdent pas de numéro, c’est cette information qui est indiquée comme
résultat du géocodage.</p>
<p>Le tableau ci-dessous schématise l’ensemble des opérations réalisées
et expliquées précédemment :</p>
<p><img src="img/phacochr4.png" width="70%"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joel Gires, Hugo Perilleux.</p>
</div>

<div class="pkgdown-footer-right">

</div>

    </footer>
</div>





  </body>
</html>
